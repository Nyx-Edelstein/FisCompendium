@{
    ViewBag.Title = "Hex Grid";
}
<style type="text/css">
    svg {
    }

    .hexfield {
        fill: transparent;
        stroke: #404040;
    }

    .hexfield:hover {
        stroke: whitesmoke;
    }

    .hexfield:focus {
        stroke: red;
        stroke-width: 2px;
        outline: none;
    }

    .hexfield:active {
        fill: red;
        outline: none;
    }

    .hexfield.selected {
        stroke: blue;
        stroke-width: 2px;
        outline: none;
    }

    .presetColor {
        height: 50px;
    }

    #hexgrid {
        left: 12px;
        top: 0px;
        z-index: 10;
    }

    #hexContainer {
        display: block;
        margin-left: 0px;
        margin-right: 0px;
        border: #202020;
        border-width: 10px;
        border-style: groove;
        width: 100%;
        height: 100%;
    }
</style>
<script src="~/lib/hexgridwidget/hexgridwidget.js" type="text/javascript"></script>

<div style="display:flex; justify-content:center; align-items:center;">
    <div style="min-width: 250px;">
        <div id="hexContainer">
            <div style="display:flex; justify-content:center; align-items:center;">
                <div id="hexgrid"></div>
            </div>
        </div>
        <hr>
        <div id="change" style="height: 50px; background-color: rgba(0, 0, 0, 99);"></div>
        <div style="display:flex; justify-content:center; align-items:center;">
            <table style="width:600px">
                <tbody>
                    <tr>
                        <td id="color0" class="presetColor" style="background-color: rgba(0, 0, 0, 0.0)"></td>
                        <td id="color1" class="presetColor" style="background-color: rgba(0, 0, 0, 0.0)"></td>
                        <td id="color2" class="presetColor" style="background-color: rgba(0, 0, 0, 0.0)"></td>
                        <td id="color3" class="presetColor" style="background-color: rgba(0, 0, 0, 0.0)"></td>
                        <td id="color4" class="presetColor" style="background-color: rgba(0, 0, 0, 0.0)"></td>
                        <td id="color5" class="presetColor" style="background-color: rgba(0, 0, 0, 0.0)"></td>
                        <td id="color6" class="presetColor" style="background-color: rgba(0, 0, 0, 0.0)"></td>
                        <td id="color7" class="presetColor" style="background-color: rgba(0, 0, 0, 0.0)"></td>
                        <td id="color8" class="presetColor" style="background-color: rgba(0, 0, 0, 0.0)"></td>
                        <td id="color9" class="presetColor" style="background-color: rgba(0, 0, 0, 0.0)"></td>
                        <td id="colorA" class="presetColor" style="background-color: rgba(0, 0, 0, 0.0)"></td>
                        <td id="colorB" class="presetColor" style="background-color: rgba(0, 0, 0, 0.0)"></td>
                        <td id="colorC" class="presetColor" style="background-color: rgba(0, 0, 0, 0.0)"></td>
                        <td id="colorD" class="presetColor" style="background-color: rgba(0, 0, 0, 0.0)"></td>
                        <td id="colorE" class="presetColor" style="background-color: rgba(0, 0, 0, 0.0)"></td>
                        <td id="colorF" class="presetColor" style="background-color: rgba(0, 0, 0, 0.0)"></td>
                    </tr>
                    <tr>
                        <td class="presetColor" style="background-color: rgba(255, 0, 0, 0.99)"></td>
                        <td class="presetColor" style="background-color: rgba(255, 128, 0, 0.99)"></td>
                        <td class="presetColor" style="background-color: rgba(255, 255, 0, 0.99)"></td>
                        <td class="presetColor" style="background-color: rgba(128, 255, 0, 0.99)"></td>
                        <td class="presetColor" style="background-color: rgba(0, 255, 0, 0.99)"></td>
                        <td class="presetColor" style="background-color: rgba(0, 255, 128, 0.99)"></td>
                        <td class="presetColor" style="background-color: rgba(0, 255, 255, 0.99)"></td>
                        <td class="presetColor" style="background-color: rgba(0, 128, 255, 0.99)"></td>
                        <td class="presetColor" style="background-color: rgba(0, 0, 255, 0.99)"></td>
                        <td class="presetColor" style="background-color: rgba(128, 0, 255, 0.99)"></td>
                        <td class="presetColor" style="background-color: rgba(255, 0, 255, 0.99)"></td>
                        <td class="presetColor" style="background-color: rgba(255, 0, 128, 0.99)"></td>
                        <td class="presetColor" style="background-color: rgba(192, 64, 64, 0.99)"></td>
                        <td class="presetColor" style="background-color: rgba(192, 192, 192, 0.99)"></td>
                        <td class="presetColor" style="background-color: rgba(96, 96, 96, 0.99)"></td>
                        <td class="presetColor" style="background-color: rgba(0, 0, 0, 0.99)"></td>
                    </tr>
                    <tr>
                        <td class="presetColor" style="background-color: rgba(255, 0, 0, 0.33)"></td>
                        <td class="presetColor" style="background-color: rgba(255, 128, 0, 0.33)"></td>
                        <td class="presetColor" style="background-color: rgba(255, 255, 0, 0.33)"></td>
                        <td class="presetColor" style="background-color: rgba(128, 255, 0, 0.33)"></td>
                        <td class="presetColor" style="background-color: rgba(0, 255, 0, 0.33)"></td>
                        <td class="presetColor" style="background-color: rgba(0, 255, 128, 0.33)"></td>
                        <td class="presetColor" style="background-color: rgba(0, 255, 255, 0.33)"></td>
                        <td class="presetColor" style="background-color: rgba(0, 128, 255, 0.33)"></td>
                        <td class="presetColor" style="background-color: rgba(0, 0, 255, 0.33)"></td>
                        <td class="presetColor" style="background-color: rgba(128, 0, 255, 0.33)"></td>
                        <td class="presetColor" style="background-color: rgba(255, 0, 255, 0.33)"></td>
                        <td class="presetColor" style="background-color: rgba(255, 0, 128, 0.33)"></td>
                        <td class="presetColor" style="background-color: rgba(192, 64, 64, 0.33)"></td>
                        <td class="presetColor" style="background-color: rgba(192, 192, 192, 0.33)"></td>
                        <td class="presetColor" style="background-color: rgba(96, 96, 96, 0.33)"></td>
                        <td class="presetColor" style="background-color: rgba(0, 0, 0, 0)"></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <br />
        <div style="display:flex; justify-content:center; align-items:center;">
            <table style="width:500px">
                <tbody>
                    <tr>
                        <th>Red</th>
                        <th>Green</th>
                        <th>Blue</th>
                        <th>Alpha</th>
                    </tr>
                    <tr>
                        <td id="valRed">0</td>
                        <td id="valGreen">0</td>
                        <td id="valBlue">0</td>
                        <td id="valAlpha">99</td>
                    </tr>
                    <tr>
                        <td>
                            <input oninput="changeRed(this.value)" onchange="changeRed(this.value)" type="range" id="slideRed" name="slideRed" min="0" max="255" value="0">
                        </td>
                        <td>
                            <input oninput="changeGreen(this.value)" onchange="changeGreen(this.value)" type="range" id="slideGreen" name="slideGreen" min="0" max="255" value="0">
                        </td>
                        <td>
                            <input oninput="changeBlue(this.value)" onchange="changeBlue(this.value)" type="range" id="slideBlue" name="slideBlue" min="0" max="255" value="0">
                        </td>
                        <td>
                            <input oninput="changeAlpha(this.value)" onchange="changeAlpha(this.value)" type="range" id="slideAlpha" name="slideAlpha" min="0" max="99" value="99">
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <hr>
        <div class="row">
            <div class="col-md-4">
                <label for="gridRows">Rows:</label>
                <input type="number" min="5" max="40" value="10" id="gridRows" style="width: 65px" />
            </div>
            <div class="col-md-4">
                <label for="gridCols">Cols:</label>
                <input type="number" min="5" max="40" value="20" id="gridCols" style="width: 65px" />
            </div>
        </div>
        <br />
        <input type="button" id="RebuildButton" value="Rebuild" style="width: 135px" />
    </div>
</div>

<script type="text/javascript">
    var select = function (row, col) {
        var ele = `#hexgrid [hex-row=${row}][hex-column=${col}]`
        $(ele).toggleClass('selected');
        $(ele).hide().show(0);
    }

    var updateRecent = function (color) {
        var colors = [
            $('#color0').css('background-color'),
            $('#color1').css('background-color'),
            $('#color2').css('background-color'),
            $('#color3').css('background-color'),
            $('#color4').css('background-color'),
            $('#color5').css('background-color'),
            $('#color6').css('background-color'),
            $('#color7').css('background-color'),
            $('#color8').css('background-color'),
            $('#color9').css('background-color'),
            $('#colorA').css('background-color'),
            $('#colorB').css('background-color'),
            $('#colorC').css('background-color'),
            $('#colorD').css('background-color'),
            $('#colorE').css('background-color'),
            $('#colorF').css('background-color')
        ];
        if (colors.includes(color)) {
            return;
        }
        $('#color0').css('background-color', colors[1]);
        $('#color1').css('background-color', colors[2]);
        $('#color2').css('background-color', colors[3]);
        $('#color3').css('background-color', colors[4]);
        $('#color4').css('background-color', colors[5]);
        $('#color5').css('background-color', colors[6]);
        $('#color6').css('background-color', colors[7]);
        $('#color7').css('background-color', colors[8]);
        $('#color8').css('background-color', colors[9]);
        $('#color9').css('background-color', colors[10]);
        $('#colorA').css('background-color', colors[11]);
        $('#colorB').css('background-color', colors[12]);
        $('#colorC').css('background-color', colors[13]);
        $('#colorD').css('background-color', colors[14]);
        $('#colorE').css('background-color', colors[15]);
        $('#colorF').css('background-color', color);
    }

    var rebuild = function () {
        var radius = 18;
        var columns = $('#gridCols').val();
        var rows = $('#gridRows').val();
        var cssClass = 'hexfield';
        $('#hexgrid').empty().hexGridWidget(radius, columns, rows, cssClass);
        $('#hexgrid .hexfield').click(function () {
            this.classList.toggle('focus');
        });
        $('#hexgrid .hexfield').dblclick(function () {
            var color = $('#change').css("background-color");
            $(this).css("fill", color);
            updateRecent(color);
        });
        $('#RebuildButton').click(rebuild);
        $('.presetColor').click(function() {
            var color = $(this).css("background-color");
            var colorString = color,
                colorsOnly = colorString.substring(colorString.indexOf('(') + 1, colorString.lastIndexOf(')')).split(/,\s*/),
                red = colorsOnly[0],
                green = colorsOnly[1],
                blue = colorsOnly[2],
                alpha = colorsOnly[3];
            document.getElementById('valRed').innerHTML = red;
            document.getElementById('slideRed').value = red;
            document.getElementById('valGreen').innerHTML = green;
            document.getElementById('slideGreen').value = green;
            document.getElementById('valBlue').innerHTML = blue;
            document.getElementById('slideBlue').value = blue;
            document.getElementById('valAlpha').innerHTML = alpha * 100;
            document.getElementById('slideAlpha').value = alpha * 100;
            $('#change').css("background-color", color);
        });
    };
    rebuild();
</script>

<script type="text/javascript">
    function changeRed(value) {
        document.getElementById('valRed').innerHTML = value;
        changeAll();
    }
    function changeGreen(value) {
        document.getElementById('valGreen').innerHTML = value;
        changeAll();
    }
    function changeBlue(value) {
        document.getElementById('valBlue').innerHTML = value;
        changeAll();
    }
    function changeAlpha(value) {
        document.getElementById('valAlpha').innerHTML = value;
        changeAll();
    }
    function changeAll() {
        var r = document.getElementById('valRed').innerHTML;
        var g = document.getElementById('valGreen').innerHTML;
        var b = document.getElementById('valBlue').innerHTML;
        var a = document.getElementById('valAlpha').innerHTML / 100.0;
        document.getElementById('change').style.backgroundColor = "rgba(" + r + "," + g + "," + b + "," + a + ")";
    }
</script>